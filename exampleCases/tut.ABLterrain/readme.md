# Instructions and general case notes

- First script requests more cores than `$nCores` for RAM workaround for `moveDynamicMesh` call. This is necessary if the `stl` file is large
- The delay for start computing averages, indicated by the variable `campAvgDelay`, _should_ be a multiple of `controlDict.writeInterval`
- The end time should be set on `controlDict.endTime`. This end time corresponds to the quasi-steady state part. The simulation will be adjusted to run for `compAvgTime` seconds after the `endTime`, saving extra information
- For precursor-mapped runs, any `coded` boundary condition gets overwritten by the `changeDictionary` call to set timeVarying-type of BC
- `0.original/T.<type>` has custom boundary conditions. Copy that as appropriate
- Terrain `stl` file not included
- Terrain handling: use `~/utilities/shiftFlatBlendToz0.sh` to shift the terrain. The script works by calling `shiftFlatBlendToz0 terrainFile.stl -1000 0`, where the numbers are the $x$ and $y$ of the inlet plane, which we want to be flush at $z=0$. The terrain is shifted such that the inlet planes do not change size with respect to the precursor boundaries
- Final mesh is assumed to be in the last saved time step from the `moveDynamicMesh` execution
- If mapping from precursor, the valocity needs to be scaled by calling `setFieldsABL` with the appropriate `scaleGiven` flag
- `setFieldsABLDict` contains `useWallDist` as `true` by default. Adjust the `temperatureInitType` as needed
- There is no need to change the bottom BC for convective cases on the second script because if it is coming from a precursor, such information is already there in `$mapTime`, and if it is a run with `$initializer != precursor`, it will be on the `qwall.<state>` and `setUp` files
- Uses temporalAveraging from SOWFA's libs for averaging
- The `lower` boundary condition for `Rwall` and `qwall` are no longer modified by changeDictionary
- For restarted runs, simply re-submit the second script, without changing


# To-do / WIP

- Script `3_getQuantities.sh` under development. Essentially a parser for some quantities from all the logfiles generated by the solver. At some point, these calls (`grep` and `awk`) were on the second script
- Include the source term handing from the precursor
- Add the statistics on and frequency back to `ABLProperties`
